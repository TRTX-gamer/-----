C51 COMPILER V9.60.0.0   WIEGAND                                                           06/27/2022 00:26:08 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE WIEGAND
OBJECT MODULE PLACED IN .\Objects\wiegand.obj
COMPILER INVOKED BY: S:\Keil_v5\C51\BIN\C51.EXE Drivers\Src\wiegand.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Core\Inc;.\Drive
                    -rs\Inc) DEBUG OBJECTEXTEND PRINT(.\Listings\wiegand.lst) TABS(2) OBJECT(.\Objects\wiegand.obj)

line level    source

   1          /******************************************************************************
   2           *实现对韦根卡的识别
   3           ******************************************************************************/
   4          #include "wiegand.h"
   5          
   6          /******************************************************************************
   7           *函数名称：initial(void)
   8           *函数功能：中断初始化
   9           *入口函数：无
  10           *出口函数：无
  11           ******************************************************************************/
  12          void initial(void)
  13          {
  14   1        // EA = 0;   //关CPU中断
  15   1        IT0 = 0; // Wiegand-Data0        低电平触发中断
  16   1        EX0 = 1; //外部中断0允许
  17   1        IT1 = 0; // Wiegand-Data1 低电平触发中断
  18   1        EX1 = 1; //外部中断1允许
  19   1        EA = 1;  //开CPU中断
  20   1      }
  21          
  22          /******************************************************************************
  23           *函数名称：udelay(uint num)
  24           *函数功能：延时函数 延时num  us
  25           *入口函数：num
  26           *出口函数：无
  27           ******************************************************************************/
  28          void udelay(uint num) // 假如用51用12m晶振
  29          {
  30   1        while (--num)
  31   1          ;
  32   1      }
  33          
  34          /******************************************************************************
  35           *函数名称：Wiegand_Data0( )
  36           *函数功能：韦根卡数据0中断处理
  37           *入口函数：无
  38           *出口函数：无
  39           ******************************************************************************/
  40          void Wiegand_Data0() interrupt 0 using 1 //中断0处理函数,使用第一组寄存器，main函数使用
             -0组寄存器，写好寄存器组可以省去寄存器入栈，提高速度
  41          {
  42   1        EX0 = 0; //关中断0
  43   1        udelay(5);
  44   1        if (DATA0 == 0) //如果INT0为低，标示0线中断
  45   1        {
  46   2          rf_card->wiegand[rf_card->global_var] = '0'; //往数组里填0
  47   2          rf_card->global_var++;
  48   2        }
  49   1        udelay(500); //延时500uS（去掉中断后的处理时间）
  50   1        EX0 = 1;   //开中断0
  51   1      }
  52          
  53          /******************************************************************************
C51 COMPILER V9.60.0.0   WIEGAND                                                           06/27/2022 00:26:08 PAGE 2   

  54           *函数名称：Wiegand_Data1( )
  55           *函数功能：韦根卡数据1中断处理
  56           *入口函数：无
  57           *出口函数：无
  58           ******************************************************************************/
  59          void Wiegand_Data1() interrupt 2 using 2 //中断1处理函数,使用第二组寄存器
  60          {
  61   1        EX1 = 0; //关中断1
  62   1        udelay(5);
  63   1        if (DATA1 == 0)
  64   1        {
  65   2          rf_card->wiegand[rf_card->global_var] = '1';
  66   2          rf_card->global_var++;
  67   2        }
  68   1        udelay(500);
  69   1        EX1 = 1; //开中断0
  70   1      }
  71          
  72          // 2022年6月26号11点35分


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    175    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
